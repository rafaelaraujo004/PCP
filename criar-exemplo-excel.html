<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criar Exemplo Excel</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #1a1a1a; color: #fff; }
        .container { max-width: 600px; margin: 0 auto; }
        button { padding: 10px 15px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; background: #4CAF50; color: white; }
        .info { background: #2196F3; padding: 15px; border-radius: 8px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Criador de Exemplo Excel</h1>
        
        <div class="info">
            <h3>üìã Modelo de Planilha</h3>
            <p>Este script cria um arquivo Excel de exemplo com o formato correto para importa√ß√£o no sistema.</p>
            <p><strong>Colunas obrigat√≥rias:</strong></p>
            <ul>
                <li>Descri√ß√£o</li>
                <li>TAG</li>
                <li>Tipo de Servi√ßo</li>
                <li>Paletes</li>
                <li>Observa√ß√µes</li>
                <li>OS</li>
                <li>Setor Solicitante</li>
                <li>Status</li>
                <li>Respons√°vel</li>
                <li>Frente</li>
                <li>Fim</li>
            </ul>
        </div>
        
        <button onclick="criarExemplo()">üìÅ Criar Arquivo Excel de Exemplo</button>
    </div>

    <script>
        function criarExemplo() {
            // Dados de exemplo no formato correto
            const dadosExemplo = [
                {
                    'Descri√ß√£o': 'COMANDO FINAL',
                    'TAG': 'CF08',
                    'Tipo de Servi√ßo': 'LAVAGEM',
                    'Paletes': 2,
                    'Observa√ß√µes': 'DEMANDA ENGENHARIA',
                    'OS': '4562410',
                    'Setor Solicitante': 'COMANDO FINAL',
                    'Status': 'FINALIZADO',
                    'Respons√°vel': 'DOMINGOS',
                    'Frente': 'EVA',
                    'Fim': '03/04/2025'
                },
                {
                    'Descri√ß√£o': 'ROLAMENTO PRINCIPAL',
                    'TAG': 'RP60',
                    'Tipo de Servi√ßo': 'PINTURA',
                    'Paletes': 1,
                    'Observa√ß√µes': '-',
                    'OS': '',
                    'Setor Solicitante': 'EQUIPAMENTOS',
                    'Status': 'FINALIZADO',
                    'Respons√°vel': 'DOMINGOS',
                    'Frente': 'EVA',
                    'Fim': '10/04/2025'
                },
                {
                    'Descri√ß√£o': 'CILINDRO DE ELEVA√á√ÉO D11',
                    'TAG': 'CL13',
                    'Tipo de Servi√ßo': 'LAVAGEM',
                    'Paletes': 1,
                    'Observa√ß√µes': '-',
                    'OS': '',
                    'Setor Solicitante': 'EQUIPAMENTOS',
                    'Status': 'EM PROCESSO',
                    'Respons√°vel': 'EUDO CONCEI√á√ÉO',
                    'Frente': 'EVA',
                    'Fim': '11/04/2025'
                }
            ];

            // Criar planilha
            const ws = XLSX.utils.json_to_sheet(dadosExemplo);
            
            // Definir larguras das colunas
            ws['!cols'] = [
                { wch: 25 }, // Descri√ß√£o
                { wch: 10 }, // TAG
                { wch: 15 }, // Tipo de Servi√ßo
                { wch: 8 },  // Paletes
                { wch: 20 }, // Observa√ß√µes
                { wch: 10 }, // OS
                { wch: 20 }, // Setor Solicitante
                { wch: 12 }, // Status
                { wch: 15 }, // Respons√°vel
                { wch: 15 }, // Frente
                { wch: 12 }  // Fim
            ];

            // Criar workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Registros');

            // Gerar nome do arquivo
            const agora = new Date();
            const timestamp = agora.toISOString().slice(0, 10);
            const nomeArquivo = `exemplo-importacao-${timestamp}.xlsx`;

            // Salvar arquivo
            XLSX.writeFile(wb, nomeArquivo);
            
            alert(`‚úÖ Arquivo ${nomeArquivo} criado com sucesso!\n\nVoc√™ pode usar este arquivo para testar a importa√ß√£o no sistema.`);
        }
    </script>
</body>
</html>
